<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAP-DocuSign Integration | Forged Technologies</title>
    <meta name="description" content="Enterprise eSignature integration connecting SAP ECC to DocuSign with OAuth 2.0, webhooks, and automated approval workflows.">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css?v=2">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%23181818' rx='8' width='100' height='100'/><path d='M25 18h50v14H39v12h30v14H39v24H25V18z' fill='%23909090'/></svg>">
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="container nav__container">
            <a href="../index.html" class="nav__logo">Forged</a>

            <button class="nav__toggle" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>

            <ul class="nav__links">
                <li><a href="../index.html" class="nav__link">Home</a></li>
                <li><a href="../solutions.html" class="nav__link nav__link--active">Solutions</a></li>
                <li><a href="../enterprise-security.html" class="nav__link">Security</a></li>
                <li><a href="../about.html" class="nav__link">About</a></li>
                <li><a href="../contact.html" class="nav__cta">Let's Talk</a></li>
            </ul>
        </div>
    </nav>

    <!-- Solution Hero -->
    <section class="solution-hero">
        <div class="container container--narrow">
            <a href="../solutions.html" style="font-size: 0.875rem; color: var(--text-muted); display: inline-flex; align-items: center; gap: 0.5rem; margin-bottom: var(--space-lg);">
                <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                    <path d="M19 12H5M12 19l-7-7 7-7"/>
                </svg>
                Back to Solutions
            </a>

            <h1>SAP-DocuSign Integration Framework</h1>
            <p class="mt-md" style="font-size: 1.125rem; max-width: 600px;">
                Complete enterprise eSignature integration connecting SAP ECC to DocuSign API
                with OAuth 2.0, real-time webhooks, and automated approval workflows.
            </p>

            <div class="solution-hero__meta mt-lg">
                <span><strong>Timeline:</strong> &lt; 1 week</span>
                <span><strong>Platform:</strong> SAP ECC / R3</span>
                <span><strong>Role:</strong> Solo architect & developer</span>
            </div>
        </div>
    </section>

    <!-- Stats -->
    <section style="padding: var(--space-2xl) 0; background: var(--bg-secondary);">
        <div class="container container--narrow">
            <div class="stats-grid">
                <div class="stat">
                    <span class="stat__number">14</span>
                    <span class="stat__label">API Methods</span>
                </div>
                <div class="stat">
                    <span class="stat__number">12</span>
                    <span class="stat__label">Database Tables</span>
                </div>
                <div class="stat">
                    <span class="stat__number">10+</span>
                    <span class="stat__label">ABAP Classes</span>
                </div>
                <div class="stat">
                    <span class="stat__number">2</span>
                    <span class="stat__label">BADI Hooks</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Solution Content -->
    <section class="solution-content">
        <div class="container container--narrow">

            <!-- The Problem -->
            <div class="solution-section">
                <h2>The Problem</h2>
                <p>
                    Enterprise approval workflows are slow. Purchase orders sit in inboxes waiting for
                    signatures. Approvers are traveling or in meetings. Paper gets lost. Audit trails
                    are incomplete.
                </p>
                <p>
                    Companies using SAP for procurement face a specific challenge: how do you connect
                    a mature (often decades-old) ERP system to modern eSignature platforms like DocuSign?
                </p>
                <p>The typical pain points:</p>
                <ul>
                    <li>Manual approval processes that take days instead of hours</li>
                    <li>No mobile capability—approvers must be at their desk</li>
                    <li>Incomplete audit trails for compliance</li>
                    <li>No visibility into where documents are stuck</li>
                    <li>Goods receipts processed before approval (compliance risk)</li>
                </ul>
            </div>

            <!-- The Solution -->
            <div class="solution-section">
                <h2>The Solution</h2>
                <p>
                    A complete integration framework that connects SAP ECC to DocuSign eSignature,
                    enabling automated approval workflows with full audit compliance.
                </p>

                <h3>Core Capabilities</h3>
                <ul>
                    <li><strong>OAuth 2.0 Authentication</strong> — Both Authorization Code Grant and JWT Bearer Grant supported, with automatic token refresh</li>
                    <li><strong>Envelope Management</strong> — Create, send, and track signature envelopes directly from SAP</li>
                    <li><strong>Real-time Webhooks</strong> — Instant notification when documents are viewed, signed, or declined via DocuSign Connect</li>
                    <li><strong>Sequential Approval</strong> — Support for multi-level approval chains (Release Strategy integration)</li>
                    <li><strong>GR Blocking</strong> — Automatically block goods receipt until all approvals complete</li>
                    <li><strong>Full Audit Trail</strong> — Every action logged with timestamps, users, and status changes</li>
                </ul>
            </div>

            <!-- Architecture -->
            <div class="solution-section">
                <h2>Architecture</h2>
                <p>
                    The solution follows a clean separation of concerns: a reusable core API package
                    (Integration Framework) that handles all DocuSign communication, and business-specific
                    implementations (Workflow Engine) that define the workflows.
                </p>

                <!-- SAP-DocuSign Architecture Diagram -->
                <div class="flow-diagram" style="padding: var(--space-2xl);">
                    <div class="flow-diagram__title">SAP-DocuSign Integration Architecture</div>

                    <svg width="100%" height="320" viewBox="0 0 700 320" fill="none" style="max-width: 700px; margin: 0 auto; display: block;">
                        <!-- Outbound Flow (Top Row) -->

                        <!-- SAP Application -->
                        <rect x="20" y="30" width="160" height="70" rx="6" fill="#2a2a2a" stroke="#505050" stroke-width="1.5"/>
                        <text x="100" y="58" fill="#e0e0e0" font-size="13" font-weight="600" text-anchor="middle">SAP Application</text>
                        <text x="100" y="78" fill="#707070" font-size="10" text-anchor="middle">ME21N, BADIs, SmartForms</text>

                        <!-- Arrow 1 -->
                        <line x1="180" y1="65" x2="230" y2="65" stroke="#606060" stroke-width="2"/>
                        <polygon points="225,60 235,65 225,70" fill="#606060"/>

                        <!-- API Core -->
                        <rect x="235" y="30" width="160" height="70" rx="6" fill="#353535" stroke="#909090" stroke-width="2"/>
                        <text x="315" y="55" fill="#e0e0e0" font-size="13" font-weight="600" text-anchor="middle">API Core</text>
                        <text x="315" y="73" fill="#808080" font-size="9" text-anchor="middle">OAuth Token | HTTP Client</text>
                        <text x="315" y="88" fill="#808080" font-size="9" text-anchor="middle">JSON Builder</text>

                        <!-- Arrow 2 -->
                        <line x1="395" y1="65" x2="445" y2="65" stroke="#606060" stroke-width="2"/>
                        <polygon points="440,60 450,65 440,70" fill="#606060"/>

                        <!-- DocuSign REST API -->
                        <rect x="450" y="30" width="160" height="70" rx="6" fill="#2a2a2a" stroke="#505050" stroke-width="1.5"/>
                        <text x="530" y="55" fill="#e0e0e0" font-size="13" font-weight="600" text-anchor="middle">DocuSign REST API</text>
                        <text x="530" y="75" fill="#707070" font-size="10" text-anchor="middle">/envelopes /documents</text>

                        <!-- Webhook Return Flow (curved path on right side) -->
                        <path d="M530 100 L530 145 L530 145" stroke="#505050" stroke-width="1.5" fill="none"/>
                        <polygon points="525,140 530,150 535,140" fill="#505050"/>

                        <!-- DocuSign Connect -->
                        <rect x="450" y="150" width="160" height="55" rx="6" fill="#2a2a2a" stroke="#505050" stroke-width="1.5"/>
                        <text x="530" y="175" fill="#e0e0e0" font-size="12" font-weight="500" text-anchor="middle">DocuSign Connect</text>
                        <text x="530" y="193" fill="#707070" font-size="10" text-anchor="middle">(Webhook)</text>

                        <!-- Arrow from DocuSign Connect to Webhook Handler -->
                        <line x1="450" y1="177" x2="400" y2="177" stroke="#505050" stroke-width="1.5"/>
                        <polygon points="405,172 395,177 405,182" fill="#505050"/>

                        <!-- Webhook Handler -->
                        <rect x="235" y="150" width="160" height="55" rx="6" fill="#353535" stroke="#909090" stroke-width="2"/>
                        <text x="315" y="172" fill="#e0e0e0" font-size="12" font-weight="600" text-anchor="middle">Webhook Handler</text>
                        <text x="315" y="190" fill="#808080" font-size="9" text-anchor="middle">Parse XML | Validate HMAC</text>

                        <!-- Arrow from Webhook to Callback -->
                        <line x1="315" y1="205" x2="315" y2="240" stroke="#606060" stroke-width="1.5"/>
                        <polygon points="310,235 315,245 320,235" fill="#606060"/>

                        <!-- Callback Interface -->
                        <rect x="235" y="245" width="160" height="60" rx="6" fill="#404040" stroke="#707070" stroke-width="1.5"/>
                        <text x="315" y="268" fill="#e0e0e0" font-size="12" font-weight="600" text-anchor="middle">Callback Interface</text>
                        <text x="315" y="288" fill="#707070" font-size="9" text-anchor="middle">on_completed() on_declined()</text>

                        <!-- Arrow from Callback back to SAP -->
                        <line x1="235" y1="275" x2="180" y2="275" stroke="#505050" stroke-width="1.5" stroke-dasharray="4"/>
                        <polygon points="185,270 175,275 185,280" fill="#505050"/>

                        <!-- Database -->
                        <rect x="20" y="150" width="160" height="155" rx="6" fill="#252525" stroke="#404040" stroke-width="1"/>
                        <text x="100" y="175" fill="#e0e0e0" font-size="12" font-weight="600" text-anchor="middle">Database</text>
                        <text x="100" y="200" fill="#606060" font-size="10" text-anchor="middle">Config</text>
                        <text x="100" y="218" fill="#606060" font-size="10" text-anchor="middle">Envelopes</text>
                        <text x="100" y="236" fill="#606060" font-size="10" text-anchor="middle">Apps Registry</text>
                        <text x="100" y="254" fill="#606060" font-size="10" text-anchor="middle">Signers</text>
                        <text x="100" y="272" fill="#606060" font-size="10" text-anchor="middle">PO Tracking</text>
                        <text x="100" y="290" fill="#505050" font-size="9" text-anchor="middle">+ audit tables</text>

                        <!-- Dashed line from API to Database -->
                        <path d="M235 85 L180 130" stroke="#404040" stroke-width="1" stroke-dasharray="4"/>
                    </svg>
                </div>

                <h3>Package Structure</h3>
                <div class="code-block">
<pre>Integration Framework/       # Core API package
├── API Core                # Main API class (OAuth, envelopes, documents)
├── Webhook Handler         # Webhook processor (XML parsing, HMAC validation)
├── Callback Interface      # Interface for business callbacks
└── Database Tables         # Configuration, envelope tracking, audit logs

Workflow Engine/             # Business integration package
├── PDF Generator           # SmartForm-based PDF generation
├── Release Callback        # PO release callback implementation
├── PO Trigger              # BADI for ME21N integration
└── GR Block Check          # BADI for goods receipt blocking</pre>
                </div>
            </div>

            <!-- Technical Highlights -->
            <div class="solution-section">
                <h2>Technical Highlights</h2>

                <h3>OAuth 2.0 Implementation</h3>
                <p>
                    Full OAuth 2.0 support with automatic token lifecycle management. The system
                    handles initial authorization, token storage, and automatic refresh before
                    expiration—no manual intervention required.
                </p>
                <ul>
                    <li>Authorization Code Grant (recommended for user-context operations)</li>
                    <li>JWT Bearer Grant (for server-to-server automation)</li>
                    <li>Secure token storage in SAP database</li>
                    <li>Automatic refresh 5 minutes before expiration</li>
                </ul>

                <h3>Webhook Processing</h3>
                <p>
                    Real-time event processing via DocuSign Connect with full security validation:
                </p>
                <ul>
                    <li>HMAC-SHA256 signature validation on every request</li>
                    <li>Idempotent processing (handles duplicate deliveries)</li>
                    <li>Event routing based on registered application callbacks</li>
                    <li>Complete audit logging of all webhook events</li>
                </ul>

                <h3>Callback Architecture</h3>
                <p>
                    The <code>Callback Interface</code> enables clean separation between
                    the API layer and business logic. New integrations simply implement the
                    interface and register with the framework:
                </p>
                <ul>
                    <li><code>on_sent()</code> — Envelope sent to signer</li>
                    <li><code>on_delivered()</code> — Signer received the document</li>
                    <li><code>on_completed()</code> — All signatures collected</li>
                    <li><code>on_declined()</code> — Signer declined to sign</li>
                    <li><code>on_voided()</code> — Envelope voided by sender</li>
                </ul>
            </div>

            <!-- Security Architecture -->
            <div class="solution-section">
                <h2>Security Architecture</h2>
                <p>
                    Enterprise integration requires enterprise-grade security. This solution implements
                    multiple security layers to protect sensitive procurement data.
                </p>

                <div class="security-highlights-grid">
                    <div class="security-highlight">
                        <div class="security-highlight__icon">
                            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"/>
                            </svg>
                        </div>
                        <div class="security-highlight__content">
                            <strong>OAuth 2.0 Implementation</strong>
                            <p>Authorization Code Grant with PKCE for interactive flows, JWT Bearer Grant for automated server-to-server operations. Tokens encrypted at rest with automatic refresh before expiry.</p>
                        </div>
                    </div>

                    <div class="security-highlight">
                        <div class="security-highlight__icon">
                            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                            </svg>
                        </div>
                        <div class="security-highlight__content">
                            <strong>Webhook Security (HMAC-SHA256)</strong>
                            <p>Every incoming webhook validated with HMAC-SHA256 signature verification. Prevents spoofed callbacks and ensures message integrity from DocuSign Connect.</p>
                        </div>
                    </div>

                    <div class="security-highlight">
                        <div class="security-highlight__icon">
                            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                            </svg>
                        </div>
                        <div class="security-highlight__content">
                            <strong>Complete Audit Trail</strong>
                            <p>Every signature event, status change, and API call logged with timestamps and user context. Supports SOC 2 compliance and regulatory audit requirements.</p>
                        </div>
                    </div>

                    <div class="security-highlight">
                        <div class="security-highlight__icon">
                            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
                            </svg>
                        </div>
                        <div class="security-highlight__content">
                            <strong>Token Lifecycle Management</strong>
                            <p>Secure credential storage with encrypted tokens in SAP database. Automatic token refresh with configurable expiry buffer prevents authentication failures.</p>
                        </div>
                    </div>
                </div>

                <p style="margin-top: var(--space-lg);">
                    <a href="../enterprise-security.html" style="color: var(--accent-primary);">Learn more about our security architecture →</a>
                </p>
            </div>

            <!-- Business Application -->
            <div class="solution-section">
                <h2>Business Application: PO Approval</h2>
                <p>
                    The framework was applied to Purchase Order approval workflows with the
                    following flow:
                </p>
                <ol style="list-style: decimal; padding-left: var(--space-xl); color: var(--text-secondary);">
                    <li style="margin-bottom: var(--space-sm);">User creates PO in ME21N</li>
                    <li style="margin-bottom: var(--space-sm);">BADI triggers envelope creation based on release strategy</li>
                    <li style="margin-bottom: var(--space-sm);">PDF generated via SmartForm with signature anchor text</li>
                    <li style="margin-bottom: var(--space-sm);">Envelope sent to first approver via DocuSign</li>
                    <li style="margin-bottom: var(--space-sm);">Sequential routing to additional approvers</li>
                    <li style="margin-bottom: var(--space-sm);">Webhook receives completion notification</li>
                    <li style="margin-bottom: var(--space-sm);">Callback triggers BAPI_PO_RELEASE</li>
                    <li style="margin-bottom: var(--space-sm);">GR block removed, PO fully released</li>
                </ol>
            </div>

            <!-- Results -->
            <div class="solution-section">
                <h2>Results</h2>
                <ul>
                    <li><strong>Approval time reduced from days to hours</strong> — Mobile-enabled signing means approvers respond faster</li>
                    <li><strong>Complete audit trail</strong> — Every signature, timestamp, and status change logged</li>
                    <li><strong>Compliance enforcement</strong> — GR blocking ensures no receipt before approval</li>
                    <li><strong>Reusable framework</strong> — Same architecture can support contracts, invoices, any document workflow</li>
                </ul>
            </div>

            <!-- Documentation Delivered -->
            <div class="solution-section">
                <h2>Documentation Delivered</h2>
                <p>
                    This project included comprehensive documentation—not just code comments, but
                    everything your team needs to understand, maintain, and extend the solution.
                </p>

                <div class="documentation-highlights">
                    <div class="doc-highlight">
                        <div class="doc-highlight__icon">
                            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                            </svg>
                        </div>
                        <div class="doc-highlight__content">
                            <strong>Architecture Documentation</strong>
                            <span>System diagrams, component relationships, data flows</span>
                        </div>
                    </div>

                    <div class="doc-highlight">
                        <div class="doc-highlight__icon">
                            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M4 7v10c0 2 1 3 3 3h10c2 0 3-1 3-3V7c0-2-1-3-3-3H7c-2 0-3 1-3 3zm0 5h16M9 3v4m6-4v4"/>
                            </svg>
                        </div>
                        <div class="doc-highlight__content">
                            <strong>Database Schema Specs</strong>
                            <span>12 tables with field-level detail, relationships, indexes</span>
                        </div>
                    </div>

                    <div class="doc-highlight">
                        <div class="doc-highlight__icon">
                            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                            </svg>
                        </div>
                        <div class="doc-highlight__content">
                            <strong>API Method Reference</strong>
                            <span>14 methods with parameters, return types, and examples</span>
                        </div>
                    </div>

                    <div class="doc-highlight">
                        <div class="doc-highlight__icon">
                            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"/>
                            </svg>
                        </div>
                        <div class="doc-highlight__content">
                            <strong>Setup & Installation Guide</strong>
                            <span>Step-by-step checklist for deployment and configuration</span>
                        </div>
                    </div>

                    <div class="doc-highlight">
                        <div class="doc-highlight__icon">
                            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                            </svg>
                        </div>
                        <div class="doc-highlight__content">
                            <strong>Error Handling & Recovery</strong>
                            <span>Troubleshooting procedures and diagnostic programs</span>
                        </div>
                    </div>

                    <div class="doc-highlight">
                        <div class="doc-highlight__icon">
                            <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/><path d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <div class="doc-highlight__content">
                            <strong>Test Programs & Validation</strong>
                            <span>Ready-to-run test utilities with sample outputs</span>
                        </div>
                    </div>
                </div>

                <!-- Architecture Documentation (Expandable) -->
                <div class="doc-preview" id="archDocSection">
                    <button class="doc-preview__toggle" onclick="toggleArchDoc()">
                        <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                            <path d="M9 5l7 7-7 7"/>
                        </svg>
                        <span>View Architecture Documentation</span>
                    </button>
                    <div class="doc-preview__content">
                        <!-- Tab Navigation -->
                        <div class="arch-doc-tabs">
                            <button class="arch-doc-tabs__btn active" onclick="showArchTab('quick-ref')">Quick Reference</button>
                            <button class="arch-doc-tabs__btn" onclick="showArchTab('oauth-flow')">OAuth Flow</button>
                            <button class="arch-doc-tabs__btn" onclick="showArchTab('callback')">Callback Methods</button>
                            <button class="arch-doc-tabs__btn" onclick="showArchTab('config')">Configuration</button>
                            <button class="arch-doc-tabs__btn" onclick="showArchTab('troubleshoot')">Troubleshooting</button>
                            <button class="arch-doc-tabs__btn" onclick="showArchTab('transactions')">SAP Transactions</button>
                        </div>

                        <!-- Tab 1: Quick Reference -->
                        <div class="arch-doc-section active" id="tab-quick-ref">
                            <h4>Key Capabilities</h4>
                            <table class="sap-table">
                                <thead>
                                    <tr>
                                        <th>Capability</th>
                                        <th>Implementation</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>OAuth 2.0</td>
                                        <td>Authorization Code Grant + JWT Bearer Grant supported</td>
                                    </tr>
                                    <tr>
                                        <td>Envelope Management</td>
                                        <td>Create, send, void envelopes with PDF attachments</td>
                                    </tr>
                                    <tr>
                                        <td>Webhook Processing</td>
                                        <td>HMAC-SHA256 validation, event routing by App ID</td>
                                    </tr>
                                    <tr>
                                        <td>Signature Anchors</td>
                                        <td>Auto-position signature fields via anchor text in PDFs</td>
                                    </tr>
                                    <tr>
                                        <td>Token Management</td>
                                        <td>Auto-refresh with configurable buffer, secure storage</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h4 style="margin-top: var(--space-lg);">Core Components</h4>
                            <table class="sap-table">
                                <thead>
                                    <tr>
                                        <th>Component</th>
                                        <th>Type</th>
                                        <th>Purpose</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>API Core Class</td>
                                        <td>Class</td>
                                        <td>Central API client - OAuth, envelope creation, status queries</td>
                                    </tr>
                                    <tr>
                                        <td>Webhook Handler</td>
                                        <td>Class</td>
                                        <td>Process incoming webhooks, validate HMAC, route to callbacks</td>
                                    </tr>
                                    <tr>
                                        <td>Callback Interface</td>
                                        <td>Interface</td>
                                        <td>Contract for application-specific event handling</td>
                                    </tr>
                                    <tr>
                                        <td>Config Table</td>
                                        <td>DB Table</td>
                                        <td>OAuth credentials, API endpoints, token storage</td>
                                    </tr>
                                    <tr>
                                        <td>App Registry Table</td>
                                        <td>DB Table</td>
                                        <td>Registered applications with callback class mappings</td>
                                    </tr>
                                    <tr>
                                        <td>Envelope Tracking Table</td>
                                        <td>DB Table</td>
                                        <td>Envelope status, timestamps, business object references</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Tab 2: OAuth Flow -->
                        <div class="arch-doc-section" id="tab-oauth-flow">
                            <h4>Authorization Code Grant Flow</h4>
                            <div class="arch-doc-flow">
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">1</span>
                                    <span>User accesses OAuth Setup BSP page</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">2</span>
                                    <span>Redirect to DocuSign login with Integration Key + Scopes</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">3</span>
                                    <span>User grants consent, DocuSign redirects back with auth code</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">4</span>
                                    <span>Exchange auth code for access token + refresh token</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">5</span>
                                    <span>Store tokens encrypted in Config Table</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">6</span>
                                    <span>Auto-refresh before expiry (configurable buffer)</span>
                                </div>
                            </div>

                            <div class="arch-doc-callout" style="margin-top: var(--space-lg);">
                                <strong>Token Refresh Logic:</strong> Access tokens expire after ~8 hours.
                                The API checks token validity before each call with a configurable buffer
                                (default 5 minutes). If expiring, refresh token is used automatically.
                            </div>

                            <h4 style="margin-top: var(--space-lg);">Envelope Creation Flow</h4>
                            <div class="arch-doc-flow">
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">1</span>
                                    <span>Business trigger (BADI, report, custom code)</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">2</span>
                                    <span>Generate PDF with signature anchor text (e.g., /sig1/)</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">3</span>
                                    <span>Build signer list with routing order</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">4</span>
                                    <span>Call API Core Class→CREATE_ENVELOPE method</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">5</span>
                                    <span>Envelope ID returned and stored in Tracking Table</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">6</span>
                                    <span>DocuSign sends emails to signers in sequence</span>
                                </div>
                            </div>
                        </div>

                        <!-- Tab 3: Callback Methods -->
                        <div class="arch-doc-section" id="tab-callback">
                            <h4>Callback Interface Methods</h4>
                            <div class="arch-doc-callout">
                                <strong>Interface Contract:</strong> Each application implements this interface
                                to handle DocuSign events. The Webhook Handler routes events based on App ID
                                stored in envelope custom fields.
                            </div>

                            <table class="sap-table" style="margin-top: var(--space-md);">
                                <thead>
                                    <tr>
                                        <th>Method</th>
                                        <th>Trigger Event</th>
                                        <th>Typical Action</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><code>ON_COMPLETED</code></td>
                                        <td>All signers completed</td>
                                        <td>Release PO, update status, trigger downstream process</td>
                                    </tr>
                                    <tr>
                                        <td><code>ON_DECLINED</code></td>
                                        <td>Any signer declined</td>
                                        <td>Notify requestor, log rejection reason</td>
                                    </tr>
                                    <tr>
                                        <td><code>ON_VOIDED</code></td>
                                        <td>Envelope voided</td>
                                        <td>Clean up pending states, remove blocks</td>
                                    </tr>
                                    <tr>
                                        <td><code>ON_SENT</code></td>
                                        <td>Envelope sent</td>
                                        <td>Update tracking status (optional)</td>
                                    </tr>
                                    <tr>
                                        <td><code>ON_DELIVERED</code></td>
                                        <td>Recipient viewed</td>
                                        <td>Log view timestamp (optional)</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h4 style="margin-top: var(--space-lg);">Webhook Processing</h4>
                            <div class="arch-doc-flow">
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">1</span>
                                    <span>DocuSign POSTs XML payload to SAP webhook endpoint</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">2</span>
                                    <span>Validate HMAC-SHA256 signature (X-DocuSign-Signature header)</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">3</span>
                                    <span>Parse XML, extract envelope ID and status</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">4</span>
                                    <span>Lookup App ID from envelope custom fields</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">5</span>
                                    <span>Instantiate callback class from App Registry</span>
                                </div>
                                <div class="arch-doc-flow__step">
                                    <span class="arch-doc-flow__num">6</span>
                                    <span>Call appropriate ON_* method based on status</span>
                                </div>
                            </div>
                        </div>

                        <!-- Tab 4: Configuration -->
                        <div class="arch-doc-section" id="tab-config">
                            <h4>DocuSign Setup</h4>
                            <ul class="arch-doc-checklist">
                                <li>Create Integration Key in DocuSign Admin</li>
                                <li>Generate Secret Key (for Authorization Code Grant)</li>
                                <li>Configure Redirect URI pointing to SAP BSP</li>
                                <li>Set required scopes: signature, impersonation</li>
                                <li>Configure Connect webhook with HMAC key</li>
                                <li>Note Account ID (GUID format) and Base URI</li>
                            </ul>

                            <h4 style="margin-top: var(--space-lg);">SAP Setup</h4>
                            <ul class="arch-doc-checklist">
                                <li>Import SSL certificates (DocuSign root + intermediate) via STRUST</li>
                                <li>Activate SICF services for BSP pages</li>
                                <li>Configure Config Table via maintenance program</li>
                                <li>Complete OAuth flow via setup BSP page</li>
                                <li>Register applications in App Registry Table</li>
                                <li>Maintain signer mappings (for PO release integration)</li>
                            </ul>

                            <h4 style="margin-top: var(--space-lg);">Config Table Fields</h4>
                            <table class="sap-table">
                                <thead>
                                    <tr>
                                        <th>Field</th>
                                        <th>Description</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>INTEGRATION_KEY</td>
                                        <td>DocuSign Integration Key (Client ID)</td>
                                    </tr>
                                    <tr>
                                        <td>SECRET_KEY</td>
                                        <td>Client Secret (encrypted storage)</td>
                                    </tr>
                                    <tr>
                                        <td>ACCOUNT_ID</td>
                                        <td>DocuSign Account GUID</td>
                                    </tr>
                                    <tr>
                                        <td>BASE_URI</td>
                                        <td>API base URL (varies by environment)</td>
                                    </tr>
                                    <tr>
                                        <td>HMAC_KEY</td>
                                        <td>Webhook signature validation key</td>
                                    </tr>
                                    <tr>
                                        <td>ACCESS_TOKEN</td>
                                        <td>Current OAuth access token (encrypted)</td>
                                    </tr>
                                    <tr>
                                        <td>REFRESH_TOKEN</td>
                                        <td>Token for obtaining new access tokens</td>
                                    </tr>
                                    <tr>
                                        <td>TOKEN_EXPIRY</td>
                                        <td>Timestamp when access token expires</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Tab 5: Troubleshooting -->
                        <div class="arch-doc-section" id="tab-troubleshoot">
                            <h4>Diagnostic Decision Tree</h4>
                            <div class="arch-doc-callout">
                                <strong>Token Issues?</strong> → Run Test Connection program → Check token expiry in Config Table →
                                Re-run OAuth setup if refresh token expired
                            </div>
                            <div class="arch-doc-callout">
                                <strong>Webhook Not Firing?</strong> → Check SICF service active → Verify DocuSign Connect config →
                                Test with manual envelope → Check SAP gateway logs
                            </div>
                            <div class="arch-doc-callout">
                                <strong>PDF Errors?</strong> → Validate PDF header (%PDF) → Check CONVERT_OTF uses BIN_FILE parameter →
                                Verify SmartForm output format
                            </div>

                            <h4 style="margin-top: var(--space-lg);">Common OAuth Errors</h4>
                            <table class="sap-table">
                                <thead>
                                    <tr>
                                        <th>Error</th>
                                        <th>Cause</th>
                                        <th>Solution</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>invalid_grant</td>
                                        <td>Refresh token expired or revoked</td>
                                        <td>Re-run complete OAuth setup flow</td>
                                    </tr>
                                    <tr>
                                        <td>consent_required</td>
                                        <td>User hasn't granted consent</td>
                                        <td>Access OAuth BSP, complete consent</td>
                                    </tr>
                                    <tr>
                                        <td>invalid_client</td>
                                        <td>Wrong Integration Key or Secret</td>
                                        <td>Verify credentials in Config Table</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h4 style="margin-top: var(--space-lg);">Common API Errors</h4>
                            <table class="sap-table">
                                <thead>
                                    <tr>
                                        <th>HTTP Code</th>
                                        <th>Meaning</th>
                                        <th>Solution</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>400</td>
                                        <td>Invalid request format</td>
                                        <td>Check JSON structure, required fields</td>
                                    </tr>
                                    <tr>
                                        <td>401</td>
                                        <td>Authentication failed</td>
                                        <td>Token expired, refresh or re-auth</td>
                                    </tr>
                                    <tr>
                                        <td>403</td>
                                        <td>Permission denied</td>
                                        <td>Check user permissions in DocuSign</td>
                                    </tr>
                                    <tr>
                                        <td>404</td>
                                        <td>Envelope not found</td>
                                        <td>Verify envelope ID, check account</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h4 style="margin-top: var(--space-lg);">Emergency Disable</h4>
                            <div class="code-block">
                                <code>
1. Deactivate SICF webhook service<br>
2. Set ACTIVE = ' ' in Config Table<br>
3. Disable BADI implementation (SE19)
                                </code>
                            </div>
                        </div>

                        <!-- Tab 6: SAP Transactions -->
                        <div class="arch-doc-section" id="tab-transactions">
                            <h4>Transaction Reference</h4>
                            <table class="sap-table">
                                <thead>
                                    <tr>
                                        <th>Transaction</th>
                                        <th>Purpose</th>
                                        <th>Usage</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>SE11</td>
                                        <td>Data Dictionary</td>
                                        <td>View/maintain database table definitions</td>
                                    </tr>
                                    <tr>
                                        <td>SE24</td>
                                        <td>Class Builder</td>
                                        <td>Maintain API classes and interfaces</td>
                                    </tr>
                                    <tr>
                                        <td>SE19</td>
                                        <td>BADI Implementation</td>
                                        <td>Activate/deactivate BADI implementations</td>
                                    </tr>
                                    <tr>
                                        <td>SM30</td>
                                        <td>Table Maintenance</td>
                                        <td>Maintain signer mappings and config</td>
                                    </tr>
                                    <tr>
                                        <td>SE38</td>
                                        <td>ABAP Editor</td>
                                        <td>Run test and diagnostic programs</td>
                                    </tr>
                                    <tr>
                                        <td>SICF</td>
                                        <td>ICF Services</td>
                                        <td>Activate/deactivate BSP and webhook services</td>
                                    </tr>
                                    <tr>
                                        <td>STRUST</td>
                                        <td>Trust Manager</td>
                                        <td>Import DocuSign SSL certificates</td>
                                    </tr>
                                    <tr>
                                        <td>SMARTFORMS</td>
                                        <td>SmartForm Builder</td>
                                        <td>Maintain PDF templates with signature anchors</td>
                                    </tr>
                                </tbody>
                            </table>

                            <h4 style="margin-top: var(--space-lg);">Test & Diagnostic Programs</h4>
                            <table class="sap-table">
                                <thead>
                                    <tr>
                                        <th>Program</th>
                                        <th>Purpose</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Config Maintenance</td>
                                        <td>Enter/update OAuth credentials and settings</td>
                                    </tr>
                                    <tr>
                                        <td>App Registration</td>
                                        <td>Register new applications with callback classes</td>
                                    </tr>
                                    <tr>
                                        <td>Connection Test</td>
                                        <td>Verify OAuth and API connectivity</td>
                                    </tr>
                                    <tr>
                                        <td>Token Monitor</td>
                                        <td>View token status and expiry times</td>
                                    </tr>
                                    <tr>
                                        <td>Envelope Diagnostic</td>
                                        <td>Troubleshoot specific envelope issues</td>
                                    </tr>
                                    <tr>
                                        <td>Status Polling</td>
                                        <td>Manual status sync (webhook backup)</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <script>
                function toggleArchDoc() {
                    document.getElementById('archDocSection').classList.toggle('expanded');
                }
                function showArchTab(tabId) {
                    // Remove active from all tabs and sections
                    document.querySelectorAll('.arch-doc-tabs__btn').forEach(btn => btn.classList.remove('active'));
                    document.querySelectorAll('.arch-doc-section').forEach(sec => sec.classList.remove('active'));
                    // Activate clicked tab and corresponding section
                    event.target.classList.add('active');
                    document.getElementById('tab-' + tabId).classList.add('active');
                }
                </script>
            </div>

            <!-- Technologies -->
            <div class="solution-section">
                <h2>Technologies</h2>
                <div class="card__tags" style="gap: var(--space-md);">
                    <span class="tag" style="font-size: 0.875rem; padding: var(--space-sm) var(--space-md);">SAP ECC</span>
                    <span class="tag" style="font-size: 0.875rem; padding: var(--space-sm) var(--space-md);">ABAP</span>
                    <span class="tag" style="font-size: 0.875rem; padding: var(--space-sm) var(--space-md);">DocuSign REST API</span>
                    <span class="tag" style="font-size: 0.875rem; padding: var(--space-sm) var(--space-md);">OAuth 2.0</span>
                    <span class="tag" style="font-size: 0.875rem; padding: var(--space-sm) var(--space-md);">Webhooks</span>
                    <span class="tag" style="font-size: 0.875rem; padding: var(--space-sm) var(--space-md);">SmartForms</span>
                    <span class="tag" style="font-size: 0.875rem; padding: var(--space-sm) var(--space-md);">BADIs</span>
                    <span class="tag" style="font-size: 0.875rem; padding: var(--space-sm) var(--space-md);">BSP</span>
                </div>
            </div>

            <!-- CTA -->
            <div style="margin-top: var(--space-3xl); padding: var(--space-2xl); background: var(--bg-secondary); border-radius: 12px; text-align: center;">
                <h3 style="margin-bottom: var(--space-md);">Need a similar integration?</h3>
                <p style="margin-bottom: var(--space-xl); max-width: 500px; margin-left: auto; margin-right: auto;">
                    We build SAP integrations with DocuSign, Salesforce, ServiceNow, and other
                    cloud platforms. Let's talk about your requirements.
                </p>
                <a href="../contact.html" class="btn btn--primary btn--large">Start a Conversation</a>
            </div>

        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container footer__content">
            <p class="footer__text">&copy; 2026 Forged Technologies. Built with focus.</p>
            <ul class="footer__links">
                <li><a href="https://www.linkedin.com/in/nathan-murray-311266114/" class="footer__link" target="_blank" rel="noopener">LinkedIn</a></li>
                <li><a href="https://github.com/natem1095" class="footer__link" target="_blank" rel="noopener">GitHub</a></li>
                <li><a href="mailto:nate@forgedintegration.com" class="footer__link">Email</a></li>
            </ul>
        </div>
    </footer>

    <script src="../js/main.js"></script>
</body>
</html>
